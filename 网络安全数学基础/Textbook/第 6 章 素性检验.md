## 6.1 伪素数

根据费马小定理可知：如果 $n$ 是一个素数，则对任意整数 $b$，$(b,n)=1$，有
$$b^{n-1}\equiv 1\pmod n$$
由此可得：如果有一个整数 $b$，$(b,n)=1$ 使得
$$b^{n-1}\not\equiv1\pmod n$$
则 $n$ 是一个合数。

### 定义 6.1.1

设 $n$ 是一个奇合数。如果整数 $b$，$(b,n)=1$ 使得同余式
$$b^{n-1}\equiv 1\pmod n$$
成立，则 $n$ 叫做对于基 $b$ 的**伪素数**。
> 素数一定满足费马小定理，但满足费马小定理的未必是素数。


### 定理 6.1.1

设 $n$ 是一个奇合数，$b,b_1,b_2$ 为与 $n$ 互素的整数，则
1. $n$ 是对于基 $b$ 的伪素数当且仅当 $b$ 模 $n$ 的阶整除 $n-1$ 。
2. 如果 $n$ 是对于基 $b_1$ 和 $b_2$ 的伪素数，则 $n$ 也是对于基 $b_1\cdot b_2$ 的伪素数。
3. 如果 $n$ 是对于基 $b$ 的伪素数，则 $n$ 也是对于基 $b^{-1} \pmod n$ 的伪素数。
4. 如果有一个整数 $b$ 使得同余式 $b^{n-1}\equiv 1\pmod n$ 不成立，那么模 $n$ 的简化剩余系中至少有一半的数不满足同余式 $b^{n-1}\equiv 1\pmod n$ 。


### 引理 6.1.1

设 $d,n$ 都是正整数，若 $d\mid n$，则 $(2^d-1)\mid (2^n-1)$。


### 定理 6.1.2

存在无穷多个对于基 $2$ 的伪素数。
> 如果 $n$ 是对于基 $2$ 的伪素数，那么 $m=2^n-1$ 也是对于基 $2$ 的伪素数。


### 算法 6.1.1（费马素性检验）

给定奇整数 $n\ge 3$ 和安全参数 $t$。
1. 随机选取整数 $b$，$(b,n)=1$，$2\le b\le n-2$。
2. 计算 $r=b^{n-1}\pmod n$ 
3. 如果 $r\ne 1$，则 $n$ 是合数。
4. 上述过程重复 $t$ 次。


### 定义 6.1.2

设 $n>1$ 为奇合数，若对于所有整数 $b$，$(b,n)=1$，都有
$$b^{n-1}\equiv 1\pmod n$$
则 $n$ 称为 $\mathrm{Carmichael}$ 数。


### 定理 6.1.4

设 $n$ 是一个奇合数
1. 如果 $n$ 被一个大于 $1$ 的平方数整除，则 $n$ 不是 $\mathrm{Carmichael}$ 数。
2. 如果 $n=p_1\cdots p_k$ 不含大于 $1$ 的平方因子，则 $n$ 是 $\mathrm{Carmichael}$ 数的充要条件是
$$p_i-1\mid n-1,\qquad 1\le i\le k$$


### 定理 6.1.5

1. 每个 $\mathrm{Carmichael}$ 数是至少三个不同素数的乘积。
2. 存在无穷个 $\mathrm{Carmichael}$ 数。
> 若 $n$ 是 $\mathrm{Carmichael}$ 数，则费马素性检验必将产生误判。



## 6.2 Euler 伪素数

设 $n$ 是奇素数，根据欧拉判别法则，有同余式
$$b^{\frac{n-1}{2}}\equiv\left(\frac{b}{n}\right)\pmod n$$
对任意整数 $b$ 成立。
因此，如果存在整数 $b$，$(b,n)=1$，使得
$$b^{\frac{n-1}{2}}\not\equiv\left(\frac{b}{n}\right)\pmod n$$
则 $n$ 不是一个素数（合数）。


### 定义 6.2.1

设 $n$ 是一个正奇合数。设整数 $b$ 与 $n$ 互素。如果整数 $n$ 和 $b$ 满足条件
$$b^{\frac{n-1}{2}}\equiv\left(\frac{b}{n}\right)\pmod n$$
则 $n$ 叫做对于基 $b$ 的 **$\mathrm{Euler}$ 伪素数**。


### 算法 6.2.1（Solovay-Stassen 素性检验）

给定奇整数 $n\ge 3$ 和安全参数 $t$
1. 随机选取整数 $b$，$2\le b\le n-2$
2. 计算 $r=b^{\frac{n-1}{2}}$
3. 如果 $r\ne 1$ 以及 $r\ne n-1$，则 $n$ 是合数。
4. 计算 $\mathrm{Jacobi}$ 符号 $s=\left(\frac{b}{n}\right)$。
5. 如果 $r\ne s$，则 $n$ 是合数。
6. 上述过程重复 $t$ 次。


### 定理 6.2.1

如果 $n$ 是对于基 $b$ 的 $\mathrm{Euler}$ 伪素数，则 $n$ 是对于基 $b$ 的伪素数。
> 反之不成立：不是每个伪素数都是 $\mathrm{Euler}$ 伪素数。


## 6.3 强伪素数

### 定义 6.3.1

设 $n$ 是一个奇合数，且有表示式 $n-1=2^st$，其中 $t$ 为奇数。设整数 $b$ 与 $n$ 互素。如果整数 $n$ 和 $b$ 满足条件
$$b^t\equiv 1\pmod n$$
或者存在一个整数 $r$，$0\le r<s$ 使得
$$b^{2^rt}\equiv -1\pmod n$$
则 $n$ 叫做对于基 $b$ 的**强伪素数**。
> 第一次 $r_0$ 是同余 $\pm 1$，后面的 $r_i$ 都是同余 $-1$ 。


### 算法 6.3.1

给定奇整数 $n\ge 3$ 和安全参数 $k$ 。写 $n-1=2^st$，其中 $t$ 为奇整数。
1. 随机选取整数 $b$，$2\le b\le n-2$
2. 计算 $r_0\equiv b^t\pmod n$
3. 
	- 如果 $r_0=1$ 或 $r_0=n-1$，则通过检验，可能为素数。回到（1），继续选取另一个随机整数 $b$，$2\le b\le n-2$
	- 否则，有 $r_0\ne 1$ 以及 $r_0\ne n-1$，计算 $r_1\equiv r_0^2\pmod n$
4. 
	- 如果 $r_1=n-1$，则通过检验，可能为素数。回到（1），继续选取另一个随机整数 $b$，$2\le b\le n-2$
	- 否则，有 $r_1\ne n-1$，计算 $r_2\equiv r_1^2\pmod n$
	如此继续下去
5. 
	- 如果 $r_{s-1}=n-1$，则通过检验，可能为素数。回到（1），继续选取另一个随机整数 $b$，$2\le b\le n-2$
	- 否则，有 $r_{s-1}\ne n-1$，$n$ 为合数

### 定理 6.3.1

存在无穷多个对于基 $2$ 的强伪素数。
> 如果 $n$ 是对于基 $2$ 的强伪素数，则 $m=2^n-1$ 是对于基 $2$ 的强伪素数。


### 定理 6.3.2

如果 $n$ 是对于基 $b$ 的强伪素数，$n$ 就是对于基 $b$ 的 $\mathrm{Euler}$ 伪素数。


### 定理 6.3.3

设 $n$ 是一个奇合数，则 $n$ 是对于基 $b\ (1\le b\le n-1)$ 的强伪素数的可能性至多为 $25\%$ 。

> $n$ 是对于基 $b$ 的强伪素数$\Longrightarrow$$n$ 是对于基 $b$ 的 $\mathrm{Euler}$ 伪素数$\Longrightarrow$$n$ 是对于基 $b$ 的伪素数

