PRG，伪随机数发生器(Pseudo-Random Number Generator)，能够生成满足统计学伪随机性的伪随机数。PRG 是一种使用数学公式来生成近似于随机数序列的数字序列的算法。PRG 生成的数字序列并不是真随机数序列，它完全由一个初始值决定，这个初始值被称为 PRG 的随机种子 Random seed，一旦种子确定了，整个随机数序列就确定了，且这个序列会周期性重复(尽管这个周期会非常大)。

在计算机编程的大部分场景下我们使用的随机数发生器都是 PRG，PRG 实际上是将少量的初始随机数(种子)扩展为大量伪随机数，在密码系统中使用的比较多。

PRG 的基本流程机制如下图所示:

![](https://pic3.zhimg.com/80/v2-63c448d808696fce26c1c8e43cea4186_1440w.webp)

PRG 机制

PRG 在内部维护了一个状态值，这个状态值需要一个初始熵值(或者说初始随机数，即种子)来初始化，每当 PRG 生成随机数时，都会根据当前状态值来计算下一个随机数，同时计算出一个新的状态值，以此类推。这样每个随机数主要取决于当前内部状态以及计算公式，不同的 PRG 主要是使用的计算公式不同，流程基本相同。

PRG 具有以下特点:

-   高效 : PRG 可以在比 TRG 短的多的时间内生成大量随机数。对很多业务场景来说，这很重要。
-   确定性 : 只要知道种子，就可以重放整个随机数序列，这显然不满足密码学安全性要求，不过在某些特殊场景下可能会有用。
-   周期性 : 从种子开始获取的随机数序列终将重复其自身。周期性也是个不满足密码学安全性要求的特征，但目前常用的 PRG 的周期都非常大，在大部分场景下都可以忽略不计。PRG 的周期越大，密码学安全性就越好。

种子对 PRG 的安全性至关重要。如果种子是时间戳这样相对而言比较好预测的数字，那么整个随机数序列也就相对容易预测。种子采用系统熵值是一个更好的选择。