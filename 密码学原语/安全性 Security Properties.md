## 一、在”完全或无“意义下的安全性：

​已知加密算法和输出的一条密文，攻击者的目标是恢复出整条明文；或者说在加密算法的基础上，给定一组明-密文对，攻击者的任务是恢复出整个密钥。攻击者或者成功地完全得到想要的秘密，或者什么都没有得到。”无“，无论在攻击之前还是攻击之后，攻击者没有得到关于秘密的任何信息。

综上，这是一种**非常弱**的公钥密码体制的安全性的概念，只考虑了被动攻击（攻击者不能操纵或修改密文），也可以说是不安全性的定义。因为明文数据很可能含有一些”先验消息“，攻击者可以知道这些消息。知道这些”部分的消息“，攻击者就很有可能得到所有的明文消息，而不是一无所获。

实际中，攻击者更有可能是主动的，同时还拥有被动窃听的能力。也就是说，攻击者可以用某种不确定的方式修改密文或者计算明文，将结果发给一个无心的用户以得到预言机服务。


## 二、$IND-CPA$ 安全性：

为了保证更强的安全性，GoldWasser 和 Micali 在 1984 年提出了概率加密，引入更强的安全目标：语义安全（理论证明，语义安全 $SS$ 等价于密文不可区分性 $IND$）。下面就**形式化**的描述密文不可区分性

敌手 $A$ 和挑战者（随机预言机 $O$ ）商定目标密码体制，选定加密密钥 $pk$ ，然后进行以下各阶段：
- 寻找阶段：敌手 $A$ 选择两个等长的明文 $m_0,m_1$，以及自认为有利攻击的辅助信息 $s$ ；
- 猜测阶段：敌手被挑战者告知其中一个明文 $m_b$ 和随机数 $r$ 的加密结果 $C^*$，当然这里的 $b$ 是保密的  
- $c_0=〖Enc〗pk ( m_0 , r )$ 若 $b=0$
- $c_1=〖Enc〗pk(m_1,r)$ 若 $b=1$
- 判断 $C^*$ 是 $c_0$ 还是 $c_1$ 。
​ 敌手 $A$ 的目标是以大于一半的概率猜对 $b$ 的值【也就是猜对的概率要比猜错的概率大 $1/2$】：
$$Adv_A=\lvert Prob_A[0\gets 敌手A(C^*=Enc_{pk}(m_0,r))]-Prob_A[0\gets 敌手A(C^*=Enc_{pk}(m_1,r))]\rvert$$
这个概率是可以忽略的，那么就说 $c_0$ 和 $c_1$ **不可区分**。

在给定明文对应的密文，任何多项式有界的攻击都不能获得有关的明文的任何先验消息。这种只能在密文攻击者是被动的情况下才是有效的，即针对 $CPA$ 下才是有效的。如果 $CCA1$ 或者 $CCA2$ 下，这种安全性就不够好。

【概率加密方案（主流做法）：加密算法是一个概率算法。在公钥和明文之外，输入一个随机数，这样，同一个明文可以使用不同的随机数加密成不同的密文。 这种方法就可以隐藏明文中的“先验信息”，从而使得密文具有不可区分性，防止 $CPA$ 这种被动攻击。】


## $IND-CCA1$ 安全性（一个稍强的安全性）：

$CCA1$ 是午餐攻击模型，因为午餐持续的时间短，所以敌手 $A$ 没有足够的时间准备他需要提问的密文，当然这里准备的密文，攻击者肯定是要想办法构造与目标密文相关的密文，使得通过解密预言机之后可以得到与目标密文对应明文相关的明文。因此午餐时间敌手 $A$ 提问的所有的密文都是午餐前准备的。

基于 $IND-CPA$ 游戏的基础之上，引入了对敌手 $A$ 的解密帮助：

敌手 $A$ 和挑战者（随机预言机 $O$ ）商定目标密码体制，选定加密密钥 $pk$，同时敌手 $A$ 在午餐前准备好一些密文消息，然后进行以下各阶段：
- 训练：敌手 $A$ 向挑战者做解密服务（可多次），即取密文 $C$ 给挑战者，挑战者返回解密结果给敌手 $A$；
- 挑战：敌手 $A$ 选择两个等长的明文 $m_0,m_1$，再从挑战者接受 $m_b$ 的密文 $C^*$，$b$ 是随机值 $(0,1)$；
- 猜测阶段：敌手输出 $b'$，如果 $b'=b$，则敌手 $A$ 成功。  
$$\begin{align*}
C_0=〖 Enc〗_{pk}(m_0,r)若b=0\\
C_1=〖 Enc〗_{pk}(m_1,r)若b=1
\end{align*}$$
- 判断 $C^*$ 是 $C_0$ 还是 $C_1$ 。
- 敌手 $A$ 的目标是以大于一半的概率猜对 $b$ 的值【也就是猜对的概率要比猜错的概率大 $1/2$】：
$$〖Adv〗_A=\lvert Pr[b'=b]-1/2\rvert$$
- 如果这个概率可忽略，那么就说这个密码体制在**非适应性选择密文攻击**下具有不可区分性。称为 $IND-CCA1$ 安全。
​午餐攻击是一个非常受限的攻击模型，敌手 $A$ 只能在很短的时间内获得提供给他的解密服务，就好像“午餐”以后解密盒被永久的关闭一样。

**【这里有个好奇的地方就是，实际中，谁会为敌手 $A$ 提供解密服务呢？】**

比如说，在某个密码协议中，要求用户一旦收到询问消息，就用她的私钥进行解密，并将结果返回，这种询问应答机制就是常见的“天真”的解密人。

实际中，这种天真的用户会永远保持天真，所以这种 $IND-CCA1$ 的安全性并不合理，只考虑短暂的用户“天真”，即短暂的解密服务，之后就不提供了。


## $IND-CCA2$ 安全性(一个更强的安全性）：

在 $IND-CCA1$ 的基础上，去掉了只能在短时间内得到解密帮助这个不现实的条件，即在这个更强安全性的攻击模型中，对敌手 $A$ 的解密帮助在午餐攻击前后都可以得到，我们取一个“美丽的”名字——**凌晨攻击**。

敌手 $A$ 和挑战者（随机预言机 $O$ ）商定目标密码体制，选定加密密钥 $pk$ ，同时敌手 $A$ 准备好一些密文消息，然后进行以下各阶段：
- 训练$1$：敌手 $A$ 向挑战者做解密服务（可多次），即取密文 $C$ 给挑战者，挑战者返回解密结果给敌手 $A$；
- 挑战：敌手 $A$选择两个等长的明文 $m_0,m_1$，再从挑战者接受 $m_b$ 的密文 $C^*$，$b$ 是随机值 $(0,1)$；
- 训练$2$：敌手 $A$ 继续向挑战者做解密服务（可多次），即取密文 $C$（$C$ 不等于 $C^*$）挑战者，挑战者解密后发送给敌手 $A$；
- 猜测阶段：敌手输出 $b'$，如果 $b'=b$，则敌手 $A$ 成功。  
$$\begin{align*}
C_0=〖 Enc〗_{pk}(m_0,r)若b=0\\
C_1=〖 Enc〗_{pk}(m_1,r)若b=1
\end{align*}$$
- 判断 $C^*$ 是 $C_0$ 还是 $C_1$ 。
- 敌手 $A$ 的目标是以大于一半的概率猜对 $b$ 的值【也就是猜对的概率要比猜错的概率大 $1/2$】：
$$〖Adv〗_A=\lvert Pr[b'=b]-1/2\rvert$$
- 如果这个概率可忽略，那么就说这个密码体制在**适应性选择密文攻击**下具有不可区分性。称为 $IND-CCA2$ 安全。
如果一个密码系统能抵抗适应性选择密文攻击，那么他则可以抵抗其余几种攻击（非适应性选择密文攻击、适应性选择明文攻击、非适应性选择明文攻击、已知明文攻击、唯密文攻击）。

**目前普遍认为，任何新提出的公钥加密算法都应该在适应性选择密文攻击下达到语义安全性，即 $IND-CCA2$ 。**
